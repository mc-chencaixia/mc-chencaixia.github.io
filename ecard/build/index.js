$(function(){var t=document.getElementById("J_canvas"),e=t.getContext("2d"),n=document.getElementById("J_imgBg"),o=$("input"),i=$("form"),a=$("#J_btnOk"),r=$("#J_btnRst"),l={name:{x:0,y:30,fontsize:"24px",color:"#5f5d5d"},title:{x:85,y:29},phone:{x:260,y:29,fontsize:"12px",color:"#5f5d5d"},telephone:{x:40,y:95},email:{x:40,y:115},net:{x:40,y:139},website:{x:240,y:114},blog:{x:240,y:93},address:{x:40,y:164}},c={net:"杭州、北京、广州、武汉、南京、宁波",website:"www.mchz.com.cn",blog:"blog.mchz.com.cn",name:"姓名",title:"职位信息",address:"杭州市拱墅区丰潭路508号天行国际中心7号楼12楼"},f={net:c.net,website:c.website,blog:c.blog,name:"",title:"",address:""},u={},d=function(){e.drawImage(n,0,0)},m=function(t,n){if(!t||!n)return!1;var o=n.fontsize||"12px",i=n.color||"#898989",a=n.font||"微软雅黑";e.font=o+" "+a,e.fillStyle=i,e.fillText(t,n.x,n.y)},g=function(){$.each(o,function(t,e){f[e.id]=e.value||c[e.id]})},s=function(){for(var n in f)m(f[n],l[n]);var o=(e.getImageData(0,0,t.width,t.height),t.toDataURL());o&&""!=o&&a.attr("href",o)},x=function(){d(),g(),s()},v=function(){if(!localStorage)return!1;var t=localStorage.getItem("cardInfo");if(!t)return!1;u=JSON.parse(t);for(var e in u)""!=u[e]&&$("#"+e).val(u[e])},y=function(){if(!localStorage)return!1;var t={name:"姓名"==f.name?"":f.name,title:"职位信息"==f.title?"":f.title,phone:f.phone,email:f.email};localStorage.setItem("cardInfo",JSON.stringify(t))};i.on("blur","input",function(t){var e=t.currentTarget;f[e.id]=""==e.value?c[e.id]:e.value,d(),s()}),a.on("click",function(){y()}),r.on("click",function(){i[0].reset(),x()});var b=function(){v(),x()};b()});